{
  "{\"filename\":\"/app/index.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.26.3": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/index.js",
      "filenameRelative": "/app/index.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "index.js",
      "sourceFileName": "index.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "index"
    },
    "ignored": false,
    "code": "// https://developers.facebook.com/docs/messenger-platform/getting-started/webhook-setup/\n// https://developers.facebook.com/docs/messenger-platform/getting-started/app-setup\n// https://developers.facebook.com/docs/messenger-platform/getting-started/quick-start\n\n\"use strict\";\n\n// Imports dependencies and set up http server\n\nvar express = require(\"express\"),\n    bodyParser = require(\"body-parser\"),\n    app = express().use(bodyParser.json()); // creates express http server\nvar request = require(\"request\");\n\n// import { checkUser, createUser } from './DBConn';\n\n// Get page access token\nvar PAGE_ACCESS_TOKEN = process.env.PAGE_ACCESS_TOKEN;\n\n// Sets server port and logs message on success\napp.listen(3000, function () {\n  return console.log(\"webhook is listening\");\n});\n\n// Adds support for GET requests to our webhook\napp.get(\"/webhook\", function (req, res) {\n  var VERIFY_TOKEN = process.env.VERIFY_TOKEN;\n\n  // Parse the query params\n  var mode = req.query[\"hub.mode\"];\n  var token = req.query[\"hub.verify_token\"];\n  var challenge = req.query[\"hub.challenge\"];\n\n  // Checks if a token and mode is in the query string of the request\n  if (mode && token) {\n    // Checks the mode and token sent is correct\n    if (mode === \"subscribe\" && token === VERIFY_TOKEN) {\n      // Responds with the challenge token from the request\n      console.log(\"WEBHOOK_VERIFIED\");\n      res.status(200).send(challenge);\n    } else {\n      // Responds with '403 Forbidden' if verify tokens do not match\n      res.sendStatus(403);\n    }\n  }\n});\n\n// Creates the endpoint for our webhook\napp.post(\"/webhook\", function (req, res) {\n  var body = req.body;\n\n  // Checks this is an event from a page subscription\n  if (body.object === \"page\") {\n    // Iterates over each entry - there may be multiple if batched\n    body.entry.forEach(function (entry) {\n      // Gets the message. entry.messaging is an array, but\n      // will only ever contain one message, so we get index 0\n      var webhook_event = entry.messaging[0];\n      // console.log(webhook_event);\n\n      // Get the sender PSID\n      var sender_psid = webhook_event.sender.id;\n      // console.log(\"Sender PSID: \" + sender_psid);\n\n      // Check if the event is a message or postback and\n      // pass the event to the appropriate handler function\n      if (webhook_event.message) {\n        // getName(sender_psid, function(response){\n        //     checkUser(sender_psid,response);\n        // });\n        handleMessage(sender_psid, webhook_event.message);\n      } else if (webhook_event.postback) {\n        handlePostback(sender_psid, webhook_event.postback);\n      }\n    });\n\n    // Returns a '200 OK' response to all requests\n    res.status(200).send(\"EVENT_RECEIVED\");\n  } else {\n    // Returns a '404 Not Found' if event is not from a page subscription\n    res.sendStatus(404);\n  }\n});\n\n// Gets users name from facebook graph api\n// function getName(sender_psid,callback){\n//     var name = \"Empty\";\n//     request({\n//         url:\"https://graph.facebook.com/v3.3/\" + sender_psid,\n//         qs:{\n//             access_token: PAGE_ACCESS_TOKEN,\n//             fields: \"first_name\",\n//         },\n//         method:\"GET\"\n//     }, function(error,response,body){\n//         if (error){\n//             console.log(error)\n//         }else{\n//             var bodyObj = JSON.parse(body);\n//             name = bodyObj.first_name;\n//             console.log(\"Name: \" + name);\n//             return callback(name)\n//         }\n//     });\n//     return name;\n// }\n\n// Handles messages events\nfunction handleMessage(sender_psid, received_message) {\n  var response = void 0;\n\n  // Check if the message contains text\n  if (received_message.text) {\n    console.log(\"Received message: \\\"\" + received_message.text + \"\\\"\");\n\n    // Default response (for debugging)\n    // Create the payload for a basic text message\n    // response = {\n    //   text: `You sent the message: \"${received_message.text}\".`\n    // };\n  } else {\n    response = defaultResponse();\n    //     // Gets the URL of the message attachment\n    //     let attachment_url = received_message.attachments[0].payload.url;\n\n    //     response = {\n    //       attachment: {\n    //         type: \"template\",\n    //         payload: {\n    //           template_type: \"generic\",\n    //           elements: [\n    //             {\n    //               title: \"Is this the right picture?\",\n    //               subtitle: \"Tap a button to answer.\",\n    //               image_url: attachment_url,\n    //               buttons: [\n    //                 {\n    //                   type: \"postback\",\n    //                   title: \"Yes!\",\n    //                   payload: \"yes\"\n    //                 },\n    //                 {\n    //                   type: \"postback\",\n    //                   title: \"No!\",\n    //                   payload: \"no\"\n    //                 }\n    //               ]\n    //             }\n    //           ]\n    //         }\n    //       }\n    //     };\n  }\n\n  // Sends the response message\n  callSendAPI(sender_psid, response);\n}\n\nfunction processMessage(message) {\n  // NLP: https://developers.facebook.com/docs/messenger-platform/built-in-nlp\n  var entities = message.nlp[\"entities\"];\n\n  // Check greeting\n  var is_greeting = entities[\"greetings\"] != null && entities[\"greetings\"][0][\"confidence\"] > 0.8; // Greeting threshold set to 0.8\n\n  // Retrieve first intent object\n  var intent = entities[\"intent\"][0];\n\n  if (intent[\"confidence\"] > 0.5) {\n    // Process intent\n    var intent_category = intent.split(\"_\")[0];\n    var response = null;\n\n    if (intent_category === \"recommendation\") {\n      // Handle recommendation\n    }\n\n    if (intent_category === \"enquiry\") {\n      // Handle enquiry\n    }\n\n    if (intent_category === \"cart\") {\n      // Handle shopping cart\n    }\n\n    if (intent_category === \"return\") {\n      // Handle order returns\n    }\n\n    if (intent_category === \"refund\") {\n      // Handle order refund\n    }\n\n    if (response === null) {\n      return defaultResponse();\n    }\n\n    return response;\n  } else if (is_greeting) {\n    // Message has no intent, just greeting\n    return generateResponseFromMessage(\"Hi there! Welcome to MINDS. How can I help you?\");\n  }\n\n  Object.keys(entities).forEach(function (key) {\n    console.log(key);\n    console.log(entities[key]);\n  });\n\n  return defaultResponse();\n}\n\nfunction defaultResponse() {\n  return generateResponseFromMessage(\"We could not understand your message. Kindly rephrase your message and send us again.\");\n}\n\nfunction generateResponseFromMessage(message) {\n  return {\n    text: message\n  };\n}\n\n// Handles messaging_postbacks events\nfunction handlePostback(sender_psid, received_postback) {\n  var response = void 0;\n\n  //   // Get the payload for the postback\n  //   let payload = received_postback.payload;\n\n  //   // Set the response based on the postback payload\n  //   if (payload === \"yes\") {\n  //     response = { text: \"Thanks!\" };\n  //   } else if (payload === \"no\") {\n  //     response = { text: \"Oops, try sending another image.\" };\n  //   }\n\n  response = defaultResponse();\n\n  // Send the message to acknowledge the postback\n  callSendAPI(sender_psid, response);\n}\n\n// Sends response messages via the Send API\nfunction callSendAPI(sender_psid, response) {\n  // Construct the message body\n  var request_body = {\n    recipient: {\n      id: sender_psid\n    },\n    message: response\n  };\n\n  // Send the HTTP request to the Messenger Platform\n  request({\n    uri: \"https://graph.facebook.com/v2.6/me/messages\",\n    qs: { access_token: PAGE_ACCESS_TOKEN },\n    method: \"POST\",\n    json: request_body\n  }, function (err, res, body) {\n    if (!err) {\n      console.log(\"message sent!\");\n    } else {\n      console.error(\"Unable to send message:\" + err);\n    }\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiYm9keVBhcnNlciIsImFwcCIsInVzZSIsImpzb24iLCJyZXF1ZXN0IiwiUEFHRV9BQ0NFU1NfVE9LRU4iLCJwcm9jZXNzIiwiZW52IiwibGlzdGVuIiwiY29uc29sZSIsImxvZyIsImdldCIsInJlcSIsInJlcyIsIlZFUklGWV9UT0tFTiIsIm1vZGUiLCJxdWVyeSIsInRva2VuIiwiY2hhbGxlbmdlIiwic3RhdHVzIiwic2VuZCIsInNlbmRTdGF0dXMiLCJwb3N0IiwiYm9keSIsIm9iamVjdCIsImVudHJ5IiwiZm9yRWFjaCIsIndlYmhvb2tfZXZlbnQiLCJtZXNzYWdpbmciLCJzZW5kZXJfcHNpZCIsInNlbmRlciIsImlkIiwibWVzc2FnZSIsImhhbmRsZU1lc3NhZ2UiLCJwb3N0YmFjayIsImhhbmRsZVBvc3RiYWNrIiwicmVjZWl2ZWRfbWVzc2FnZSIsInJlc3BvbnNlIiwidGV4dCIsImRlZmF1bHRSZXNwb25zZSIsImNhbGxTZW5kQVBJIiwicHJvY2Vzc01lc3NhZ2UiLCJlbnRpdGllcyIsIm5scCIsImlzX2dyZWV0aW5nIiwiaW50ZW50IiwiaW50ZW50X2NhdGVnb3J5Iiwic3BsaXQiLCJnZW5lcmF0ZVJlc3BvbnNlRnJvbU1lc3NhZ2UiLCJPYmplY3QiLCJrZXlzIiwia2V5IiwicmVjZWl2ZWRfcG9zdGJhY2siLCJyZXF1ZXN0X2JvZHkiLCJyZWNpcGllbnQiLCJ1cmkiLCJxcyIsImFjY2Vzc190b2tlbiIsIm1ldGhvZCIsImVyciIsImVycm9yIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBQ0EsSUFBTUEsVUFBVUMsUUFBUSxTQUFSLENBQWhCO0FBQUEsSUFDRUMsYUFBYUQsUUFBUSxhQUFSLENBRGY7QUFBQSxJQUVFRSxNQUFNSCxVQUFVSSxHQUFWLENBQWNGLFdBQVdHLElBQVgsRUFBZCxDQUZSLEMsQ0FFMEM7QUFDMUMsSUFBTUMsVUFB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QixTQUFPUyw0QkFDTCx1RkFESyxDQUFQO0FBR0Q7O0FBRUQsU0FBU0EsMkJBQVQsQ0FBcUNoQixPQUFyQyxFQUE4QztBQUM1QyxTQUFPO0FBQ0xNLFVBQU1OO0FBREQsR0FBUDtBQUdEOztBQUVEO0FBQ0EsU0FBU0csY0FBVCxDQUF3Qk4sV0FBeEIsRUFBcUN1QixpQkFBckMsRUFBd0Q7QUFDdEQsTUFBSWYsaUJBQUo7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUVBLGFBQVdFLGlCQUFYOztBQUVBO0FBQ0FDLGNBQVlYLFdBQVosRUFBeUJRLFFBQXpCO0FBQ0Q7O0FBRUQ7QUFDQSxTQUFTRyxXQUFULENBQXFCWCxXQUFyQixFQUFrQ1EsUUFBbEMsRUFBNEM7QUFDMUM7QUFDQSxNQUFJZ0IsZUFBZTtBQUNqQkMsZUFBVztBQUNUdkIsVUFBSUY7QUFESyxLQURNO0FBSWpCRyxhQUFTSztBQUpRLEdBQW5COztBQU9BO0FBQ0FqQyxVQUNFO0FBQ0VtRCxTQUFLLDZDQURQO0FBRUVDLFFBQUksRUFBRUMsY0FBY3BELGlCQUFoQixFQUZOO0FBR0VxRCxZQUFRLE1BSFY7QUFJRXZELFVBQU1rRDtBQUpSLEdBREYsRUFPRSxVQUFDTSxHQUFELEVBQU05QyxHQUFOLEVBQVdVLElBQVgsRUFBb0I7QUFDbEIsUUFBSSxDQUFDb0MsR0FBTCxFQUFVO0FBQ1JsRCxjQUFRQyxHQUFSLENBQVksZUFBWjtBQUNELEtBRkQsTUFFTztBQUNMRCxjQUFRbUQsS0FBUixDQUFjLDRCQUE0QkQsR0FBMUM7QUFDRDtBQUNGLEdBYkg7QUFlRCIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZVJvb3QiOiIvYXBwIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmZhY2Vib29rLmNvbS9kb2NzL21lc3Nlbmdlci1wbGF0Zm9ybS9nZXR0aW5nLXN0YXJ0ZWQvd2ViaG9vay1zZXR1cC9cbi8vIGh0dHBzOi8vZGV2ZWxvcGVycy5mYWNlYm9vay5jb20vZG9jcy9tZXNzZW5nZXItcGxhdGZvcm0vZ2V0dGluZy1zdGFydGVkL2FwcC1zZXR1cFxuLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmZhY2Vib29rLmNvbS9kb2NzL21lc3Nlbmdlci1wbGF0Zm9ybS9nZXR0aW5nLXN0YXJ0ZWQvcXVpY2stc3RhcnRcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIEltcG9ydHMgZGVwZW5kZW5jaWVzIGFuZCBzZXQgdXAgaHR0cCBzZXJ2ZXJcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKFwiZXhwcmVzc1wiKSxcbiAgYm9keVBhcnNlciA9IHJlcXVpcmUoXCJib2R5LXBhcnNlclwiKSxcbiAgYXBwID0gZXhwcmVzcygpLnVzZShib2R5UGFyc2VyLmpzb24oKSk7IC8vIGNyZWF0ZXMgZXhwcmVzcyBodHRwIHNlcnZlclxuY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoXCJyZXF1ZXN0XCIpO1xuXG4vLyBpbXBvcnQgeyBjaGVja1VzZXIsIGNyZWF0ZVVzZXIgfSBmcm9tICcuL0RCQ29ubic7XG5cbi8vIEdldCBwYWdlIGFjY2VzcyB0b2tlblxuY29uc3QgUEFHRV9BQ0NFU1NfVE9LRU4gPSBwcm9jZXNzLmVudi5QQUdFX0FDQ0VTU19UT0tFTjtcblxuLy8gU2V0cyBzZXJ2ZXIgcG9ydCBhbmQgbG9ncyBtZXNzYWdlIG9uIHN1Y2Nlc3NcbmFwcC5saXN0ZW4oMzAwMCwgKCkgPT4gY29uc29sZS5sb2coXCJ3ZWJob29rIGlzIGxpc3RlbmluZ1wiKSk7XG5cbi8vIEFkZHMgc3VwcG9ydCBmb3IgR0VUIHJlcXVlc3RzIHRvIG91ciB3ZWJob29rXG5hcHAuZ2V0KFwiL3dlYmhvb2tcIiwgKHJlcSwgcmVzKSA9PiB7XG4gIGxldCBWRVJJRllfVE9LRU4gPSBwcm9jZXNzLmVudi5WRVJJRllfVE9LRU47XG5cbiAgLy8gUGFyc2UgdGhlIHF1ZXJ5IHBhcmFtc1xuICBsZXQgbW9kZSA9IHJlcS5xdWVyeVtcImh1Yi5tb2RlXCJdO1xuICBsZXQgdG9rZW4gPSByZXEucXVlcnlbXCJodWIudmVyaWZ5X3Rva2VuXCJdO1xuICBsZXQgY2hhbGxlbmdlID0gcmVxLnF1ZXJ5W1wiaHViLmNoYWxsZW5nZVwiXTtcblxuICAvLyBDaGVja3MgaWYgYSB0b2tlbiBhbmQgbW9kZSBpcyBpbiB0aGUgcXVlcnkgc3RyaW5nIG9mIHRoZSByZXF1ZXN0XG4gIGlmIChtb2RlICYmIHRva2VuKSB7XG4gICAgLy8gQ2hlY2tzIHRoZSBtb2RlIGFuZCB0b2tlbiBzZW50IGlzIGNvcnJlY3RcbiAgICBpZiAobW9kZSA9PT0gXCJzdWJzY3JpYmVcIiAmJiB0b2tlbiA9PT0gVkVSSUZZX1RPS0VOKSB7XG4gICAgICAvLyBSZXNwb25kcyB3aXRoIHRoZSBjaGFsbGVuZ2UgdG9rZW4gZnJvbSB0aGUgcmVxdWVzdFxuICAgICAgY29uc29sZS5sb2coXCJXRUJIT09LX1ZFUklGSUVEXCIpO1xuICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoY2hhbGxlbmdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gUmVzcG9uZHMgd2l0aCAnNDAzIEZvcmJpZGRlbicgaWYgdmVyaWZ5IHRva2VucyBkbyBub3QgbWF0Y2hcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDQwMyk7XG4gICAgfVxuICB9XG59KTtcblxuLy8gQ3JlYXRlcyB0aGUgZW5kcG9pbnQgZm9yIG91ciB3ZWJob29rXG5hcHAucG9zdChcIi93ZWJob29rXCIsIChyZXEsIHJlcykgPT4ge1xuICBsZXQgYm9keSA9IHJlcS5ib2R5O1xuXG4gIC8vIENoZWNrcyB0aGlzIGlzIGFuIGV2ZW50IGZyb20gYSBwYWdlIHN1YnNjcmlwdGlvblxuICBpZiAoYm9keS5vYmplY3QgPT09IFwicGFnZVwiKSB7XG4gICAgLy8gSXRlcmF0ZXMgb3ZlciBlYWNoIGVudHJ5IC0gdGhlcmUgbWF5IGJlIG11bHRpcGxlIGlmIGJhdGNoZWRcbiAgICBib2R5LmVudHJ5LmZvckVhY2goZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgIC8vIEdldHMgdGhlIG1lc3NhZ2UuIGVudHJ5Lm1lc3NhZ2luZyBpcyBhbiBhcnJheSwgYnV0XG4gICAgICAvLyB3aWxsIG9ubHkgZXZlciBjb250YWluIG9uZSBtZXNzYWdlLCBzbyB3ZSBnZXQgaW5kZXggMFxuICAgICAgbGV0IHdlYmhvb2tfZXZlbnQgPSBlbnRyeS5tZXNzYWdpbmdbMF07XG4gICAgICAvLyBjb25zb2xlLmxvZyh3ZWJob29rX2V2ZW50KTtcblxuICAgICAgLy8gR2V0IHRoZSBzZW5kZXIgUFNJRFxuICAgICAgbGV0IHNlbmRlcl9wc2lkID0gd2ViaG9va19ldmVudC5zZW5kZXIuaWQ7XG4gICAgICAvLyBjb25zb2xlLmxvZyhcIlNlbmRlciBQU0lEOiBcIiArIHNlbmRlcl9wc2lkKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIGV2ZW50IGlzIGEgbWVzc2FnZSBvciBwb3N0YmFjayBhbmRcbiAgICAgIC8vIHBhc3MgdGhlIGV2ZW50IHRvIHRoZSBhcHByb3ByaWF0ZSBoYW5kbGVyIGZ1bmN0aW9uXG4gICAgICBpZiAod2ViaG9va19ldmVudC5tZXNzYWdlKSB7XG4gICAgICAgIC8vIGdldE5hbWUoc2VuZGVyX3BzaWQsIGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgLy8gICAgIGNoZWNrVXNlcihzZW5kZXJfcHNpZCxyZXNwb25zZSk7XG4gICAgICAgIC8vIH0pO1xuICAgICAgICBoYW5kbGVNZXNzYWdlKHNlbmRlcl9wc2lkLCB3ZWJob29rX2V2ZW50Lm1lc3NhZ2UpO1xuICAgICAgfSBlbHNlIGlmICh3ZWJob29rX2V2ZW50LnBvc3RiYWNrKSB7XG4gICAgICAgIGhhbmRsZVBvc3RiYWNrKHNlbmRlcl9wc2lkLCB3ZWJob29rX2V2ZW50LnBvc3RiYWNrKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFJldHVybnMgYSAnMjAwIE9LJyByZXNwb25zZSB0byBhbGwgcmVxdWVzdHNcbiAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChcIkVWRU5UX1JFQ0VJVkVEXCIpO1xuICB9IGVsc2Uge1xuICAgIC8vIFJldHVybnMgYSAnNDA0IE5vdCBGb3VuZCcgaWYgZXZlbnQgaXMgbm90IGZyb20gYSBwYWdlIHN1YnNjcmlwdGlvblxuICAgIHJlcy5zZW5kU3RhdHVzKDQwNCk7XG4gIH1cbn0pO1xuXG4vLyBHZXRzIHVzZXJzIG5hbWUgZnJvbSBmYWNlYm9vayBncmFwaCBhcGlcbi8vIGZ1bmN0aW9uIGdldE5hbWUoc2VuZGVyX3BzaWQsY2FsbGJhY2spe1xuLy8gICAgIHZhciBuYW1lID0gXCJFbXB0eVwiO1xuLy8gICAgIHJlcXVlc3Qoe1xuLy8gICAgICAgICB1cmw6XCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92My4zL1wiICsgc2VuZGVyX3BzaWQsXG4vLyAgICAgICAgIHFzOntcbi8vICAgICAgICAgICAgIGFjY2Vzc190b2tlbjogUEFHRV9BQ0NFU1NfVE9LRU4sXG4vLyAgICAgICAgICAgICBmaWVsZHM6IFwiZmlyc3RfbmFtZVwiLFxuLy8gICAgICAgICB9LFxuLy8gICAgICAgICBtZXRob2Q6XCJHRVRcIlxuLy8gICAgIH0sIGZ1bmN0aW9uKGVycm9yLHJlc3BvbnNlLGJvZHkpe1xuLy8gICAgICAgICBpZiAoZXJyb3Ipe1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4vLyAgICAgICAgIH1lbHNle1xuLy8gICAgICAgICAgICAgdmFyIGJvZHlPYmogPSBKU09OLnBhcnNlKGJvZHkpO1xuLy8gICAgICAgICAgICAgbmFtZSA9IGJvZHlPYmouZmlyc3RfbmFtZTtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTmFtZTogXCIgKyBuYW1lKTtcbi8vICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhuYW1lKVxuLy8gICAgICAgICB9XG4vLyAgICAgfSk7XG4vLyAgICAgcmV0dXJuIG5hbWU7XG4vLyB9XG5cbi8vIEhhbmRsZXMgbWVzc2FnZXMgZXZlbnRzXG5mdW5jdGlvbiBoYW5kbGVNZXNzYWdlKHNlbmRlcl9wc2lkLCByZWNlaXZlZF9tZXNzYWdlKSB7XG4gIGxldCByZXNwb25zZTtcbiAgXG4gIC8vIENoZWNrIGlmIHRoZSBtZXNzYWdlIGNvbnRhaW5zIHRleHRcbiAgaWYgKHJlY2VpdmVkX21lc3NhZ2UudGV4dCkge1xuICAgIGNvbnNvbGUubG9nKGBSZWNlaXZlZCBtZXNzYWdlOiBcIiR7cmVjZWl2ZWRfbWVzc2FnZS50ZXh0fVwiYCk7XG4gICAgXG4gICAgLy8gRGVmYXVsdCByZXNwb25zZSAoZm9yIGRlYnVnZ2luZylcbiAgICAvLyBDcmVhdGUgdGhlIHBheWxvYWQgZm9yIGEgYmFzaWMgdGV4dCBtZXNzYWdlXG4gICAgLy8gcmVzcG9uc2UgPSB7XG4gICAgLy8gICB0ZXh0OiBgWW91IHNlbnQgdGhlIG1lc3NhZ2U6IFwiJHtyZWNlaXZlZF9tZXNzYWdlLnRleHR9XCIuYFxuICAgIC8vIH07XG4gIH0gZWxzZSB7XG4gICAgcmVzcG9uc2UgPSBkZWZhdWx0UmVzcG9uc2UoKTtcbi8vICAgICAvLyBHZXRzIHRoZSBVUkwgb2YgdGhlIG1lc3NhZ2UgYXR0YWNobWVudFxuLy8gICAgIGxldCBhdHRhY2htZW50X3VybCA9IHJlY2VpdmVkX21lc3NhZ2UuYXR0YWNobWVudHNbMF0ucGF5bG9hZC51cmw7XG4gICAgXG4vLyAgICAgcmVzcG9uc2UgPSB7XG4vLyAgICAgICBhdHRhY2htZW50OiB7XG4vLyAgICAgICAgIHR5cGU6IFwidGVtcGxhdGVcIixcbi8vICAgICAgICAgcGF5bG9hZDoge1xuLy8gICAgICAgICAgIHRlbXBsYXRlX3R5cGU6IFwiZ2VuZXJpY1wiLFxuLy8gICAgICAgICAgIGVsZW1lbnRzOiBbXG4vLyAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgIHRpdGxlOiBcIklzIHRoaXMgdGhlIHJpZ2h0IHBpY3R1cmU/XCIsXG4vLyAgICAgICAgICAgICAgIHN1YnRpdGxlOiBcIlRhcCBhIGJ1dHRvbiB0byBhbnN3ZXIuXCIsXG4vLyAgICAgICAgICAgICAgIGltYWdlX3VybDogYXR0YWNobWVudF91cmwsXG4vLyAgICAgICAgICAgICAgIGJ1dHRvbnM6IFtcbi8vICAgICAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgICB0eXBlOiBcInBvc3RiYWNrXCIsXG4vLyAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJZZXMhXCIsXG4vLyAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBcInllc1wiXG4vLyAgICAgICAgICAgICAgICAgfSxcbi8vICAgICAgICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICAgICAgICB0eXBlOiBcInBvc3RiYWNrXCIsXG4vLyAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJObyFcIixcbi8vICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IFwibm9cIlxuLy8gICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgICAgXVxuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgIF1cbi8vICAgICAgICAgfVxuLy8gICAgICAgfVxuLy8gICAgIH07XG4gICAgXG4gIH1cblxuICAvLyBTZW5kcyB0aGUgcmVzcG9uc2UgbWVzc2FnZVxuICBjYWxsU2VuZEFQSShzZW5kZXJfcHNpZCwgcmVzcG9uc2UpO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzTWVzc2FnZShtZXNzYWdlKSB7XG4gIC8vIE5MUDogaHR0cHM6Ly9kZXZlbG9wZXJzLmZhY2Vib29rLmNvbS9kb2NzL21lc3Nlbmdlci1wbGF0Zm9ybS9idWlsdC1pbi1ubHBcbiAgbGV0IGVudGl0aWVzID0gbWVzc2FnZS5ubHBbXCJlbnRpdGllc1wiXTtcblxuICAvLyBDaGVjayBncmVldGluZ1xuICBsZXQgaXNfZ3JlZXRpbmcgPVxuICAgIGVudGl0aWVzW1wiZ3JlZXRpbmdzXCJdICE9IG51bGwgJiZcbiAgICBlbnRpdGllc1tcImdyZWV0aW5nc1wiXVswXVtcImNvbmZpZGVuY2VcIl0gPiAwLjg7IC8vIEdyZWV0aW5nIHRocmVzaG9sZCBzZXQgdG8gMC44XG5cbiAgLy8gUmV0cmlldmUgZmlyc3QgaW50ZW50IG9iamVjdFxuICBsZXQgaW50ZW50ID0gZW50aXRpZXNbXCJpbnRlbnRcIl1bMF07XG5cbiAgaWYgKGludGVudFtcImNvbmZpZGVuY2VcIl0gPiAwLjUpIHtcbiAgICAvLyBQcm9jZXNzIGludGVudFxuICAgIGxldCBpbnRlbnRfY2F0ZWdvcnkgPSBpbnRlbnQuc3BsaXQoXCJfXCIpWzBdO1xuICAgIGxldCByZXNwb25zZSA9IG51bGw7XG5cbiAgICBpZiAoaW50ZW50X2NhdGVnb3J5ID09PSBcInJlY29tbWVuZGF0aW9uXCIpIHtcbiAgICAgIC8vIEhhbmRsZSByZWNvbW1lbmRhdGlvblxuICAgIH1cblxuICAgIGlmIChpbnRlbnRfY2F0ZWdvcnkgPT09IFwiZW5xdWlyeVwiKSB7XG4gICAgICAvLyBIYW5kbGUgZW5xdWlyeVxuICAgIH1cblxuICAgIGlmIChpbnRlbnRfY2F0ZWdvcnkgPT09IFwiY2FydFwiKSB7XG4gICAgICAvLyBIYW5kbGUgc2hvcHBpbmcgY2FydFxuICAgIH1cblxuICAgIGlmIChpbnRlbnRfY2F0ZWdvcnkgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgIC8vIEhhbmRsZSBvcmRlciByZXR1cm5zXG4gICAgfVxuXG4gICAgaWYgKGludGVudF9jYXRlZ29yeSA9PT0gXCJyZWZ1bmRcIikge1xuICAgICAgLy8gSGFuZGxlIG9yZGVyIHJlZnVuZFxuICAgIH1cblxuICAgIGlmIChyZXNwb25zZSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRSZXNwb25zZSgpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfSBlbHNlIGlmIChpc19ncmVldGluZykge1xuICAgIC8vIE1lc3NhZ2UgaGFzIG5vIGludGVudCwganVzdCBncmVldGluZ1xuICAgIHJldHVybiBnZW5lcmF0ZVJlc3BvbnNlRnJvbU1lc3NhZ2UoXG4gICAgICBcIkhpIHRoZXJlISBXZWxjb21lIHRvIE1JTkRTLiBIb3cgY2FuIEkgaGVscCB5b3U/XCJcbiAgICApO1xuICB9XG5cbiAgT2JqZWN0LmtleXMoZW50aXRpZXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICBjb25zb2xlLmxvZyhrZXkpO1xuICAgIGNvbnNvbGUubG9nKGVudGl0aWVzW2tleV0pO1xuICB9KTtcblxuICByZXR1cm4gZGVmYXVsdFJlc3BvbnNlKCk7XG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRSZXNwb25zZSgpIHtcbiAgcmV0dXJuIGdlbmVyYXRlUmVzcG9uc2VGcm9tTWVzc2FnZShcbiAgICBcIldlIGNvdWxkIG5vdCB1bmRlcnN0YW5kIHlvdXIgbWVzc2FnZS4gS2luZGx5IHJlcGhyYXNlIHlvdXIgbWVzc2FnZSBhbmQgc2VuZCB1cyBhZ2Fpbi5cIlxuICApO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVJlc3BvbnNlRnJvbU1lc3NhZ2UobWVzc2FnZSkge1xuICByZXR1cm4ge1xuICAgIHRleHQ6IG1lc3NhZ2VcbiAgfTtcbn1cblxuLy8gSGFuZGxlcyBtZXNzYWdpbmdfcG9zdGJhY2tzIGV2ZW50c1xuZnVuY3Rpb24gaGFuZGxlUG9zdGJhY2soc2VuZGVyX3BzaWQsIHJlY2VpdmVkX3Bvc3RiYWNrKSB7XG4gIGxldCByZXNwb25zZTtcbiAgXG4vLyAgIC8vIEdldCB0aGUgcGF5bG9hZCBmb3IgdGhlIHBvc3RiYWNrXG4vLyAgIGxldCBwYXlsb2FkID0gcmVjZWl2ZWRfcG9zdGJhY2sucGF5bG9hZDtcbiAgXG4vLyAgIC8vIFNldCB0aGUgcmVzcG9uc2UgYmFzZWQgb24gdGhlIHBvc3RiYWNrIHBheWxvYWRcbi8vICAgaWYgKHBheWxvYWQgPT09IFwieWVzXCIpIHtcbi8vICAgICByZXNwb25zZSA9IHsgdGV4dDogXCJUaGFua3MhXCIgfTtcbi8vICAgfSBlbHNlIGlmIChwYXlsb2FkID09PSBcIm5vXCIpIHtcbi8vICAgICByZXNwb25zZSA9IHsgdGV4dDogXCJPb3BzLCB0cnkgc2VuZGluZyBhbm90aGVyIGltYWdlLlwiIH07XG4vLyAgIH1cbiAgXG4gIHJlc3BvbnNlID0gZGVmYXVsdFJlc3BvbnNlKCk7XG4gIFxuICAvLyBTZW5kIHRoZSBtZXNzYWdlIHRvIGFja25vd2xlZGdlIHRoZSBwb3N0YmFja1xuICBjYWxsU2VuZEFQSShzZW5kZXJfcHNpZCwgcmVzcG9uc2UpO1xufVxuXG4vLyBTZW5kcyByZXNwb25zZSBtZXNzYWdlcyB2aWEgdGhlIFNlbmQgQVBJXG5mdW5jdGlvbiBjYWxsU2VuZEFQSShzZW5kZXJfcHNpZCwgcmVzcG9uc2UpIHtcbiAgLy8gQ29uc3RydWN0IHRoZSBtZXNzYWdlIGJvZHlcbiAgbGV0IHJlcXVlc3RfYm9keSA9IHtcbiAgICByZWNpcGllbnQ6IHtcbiAgICAgIGlkOiBzZW5kZXJfcHNpZFxuICAgIH0sXG4gICAgbWVzc2FnZTogcmVzcG9uc2VcbiAgfTtcblxuICAvLyBTZW5kIHRoZSBIVFRQIHJlcXVlc3QgdG8gdGhlIE1lc3NlbmdlciBQbGF0Zm9ybVxuICByZXF1ZXN0KFxuICAgIHtcbiAgICAgIHVyaTogXCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92Mi42L21lL21lc3NhZ2VzXCIsXG4gICAgICBxczogeyBhY2Nlc3NfdG9rZW46IFBBR0VfQUNDRVNTX1RPS0VOIH0sXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAganNvbjogcmVxdWVzdF9ib2R5XG4gICAgfSxcbiAgICAoZXJyLCByZXMsIGJvZHkpID0+IHtcbiAgICAgIGlmICghZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwibWVzc2FnZSBzZW50IVwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmFibGUgdG8gc2VuZCBtZXNzYWdlOlwiICsgZXJyKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "express",
        "require",
        "bodyParser",
        "app",
        "use",
        "json",
        "request",
        "PAGE_ACCESS_TOKEN",
        "process",
        "env",
        "listen",
        "console",
        "log",
        "get",
        "req",
        "res",
        "VERIFY_TOKEN",
        "mode",
        "query",
        "token",
        "challenge",
        "status",
        "send",
        "sendStatus",
        "post",
        "body",
        "object",
        "entry",
        "forEach",
        "webhook_event",
        "messaging",
        "sender_psid",
        "sender",
        "id",
        "message",
        "handleMessage",
        "postback",
        "handlePostback",
        "received_message",
        "response",
        "text",
        "defaultResponse",
        "callSendAPI",
        "processMessage",
        "entities",
        "nlp",
        "is_greeting",
        "intent",
        "intent_category",
        "split",
        "generateResponseFromMessage",
        "Object",
        "keys",
        "key",
        "received_postback",
        "request_body",
        "recipient",
        "uri",
        "qs",
        "access_token",
        "method",
        "err",
        "error"
      ],
      "mappings": "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",
      "file": "index.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "// https://developers.facebook.com/docs/messenger-platform/getting-started/webhook-setup/\n// https://developers.facebook.com/docs/messenger-platform/getting-started/app-setup\n// https://developers.facebook.com/docs/messenger-platform/getting-started/quick-start\n\n\"use strict\";\n\n// Imports dependencies and set up http server\nconst express = require(\"express\"),\n  bodyParser = require(\"body-parser\"),\n  app = express().use(bodyParser.json()); // creates express http server\nconst request = require(\"request\");\n\n// import { checkUser, createUser } from './DBConn';\n\n// Get page access token\nconst PAGE_ACCESS_TOKEN = process.env.PAGE_ACCESS_TOKEN;\n\n// Sets server port and logs message on success\napp.listen(3000, () => console.log(\"webhook is listening\"));\n\n// Adds support for GET requests to our webhook\napp.get(\"/webhook\", (req, res) => {\n  let VERIFY_TOKEN = process.env.VERIFY_TOKEN;\n\n  // Parse the query params\n  let mode = req.query[\"hub.mode\"];\n  let token = req.query[\"hub.verify_token\"];\n  let challenge = req.query[\"hub.challenge\"];\n\n  // Checks if a token and mode is in the query string of the request\n  if (mode && token) {\n    // Checks the mode and token sent is correct\n    if (mode === \"subscribe\" && token === VERIFY_TOKEN) {\n      // Responds with the challenge token from the request\n      console.log(\"WEBHOOK_VERIFIED\");\n      res.status(200).send(challenge);\n    } else {\n      // Responds with '403 Forbidden' if verify tokens do not match\n      res.sendStatus(403);\n    }\n  }\n});\n\n// Creates the endpoint for our webhook\napp.post(\"/webhook\", (req, res) => {\n  let body = req.body;\n\n  // Checks this is an event from a page subscription\n  if (body.object === \"page\") {\n    // Iterates over each entry - there may be multiple if batched\n    body.entry.forEach(function(entry) {\n      // Gets the message. entry.messaging is an array, but\n      // will only ever contain one message, so we get index 0\n      let webhook_event = entry.messaging[0];\n      // console.log(webhook_event);\n\n      // Get the sender PSID\n      let sender_psid = webhook_event.sender.id;\n      // console.log(\"Sender PSID: \" + sender_psid);\n      \n      // Check if the event is a message or postback and\n      // pass the event to the appropriate handler function\n      if (webhook_event.message) {\n        // getName(sender_psid, function(response){\n        //     checkUser(sender_psid,response);\n        // });\n        handleMessage(sender_psid, webhook_event.message);\n      } else if (webhook_event.postback) {\n        handlePostback(sender_psid, webhook_event.postback);\n      }\n    });\n\n    // Returns a '200 OK' response to all requests\n    res.status(200).send(\"EVENT_RECEIVED\");\n  } else {\n    // Returns a '404 Not Found' if event is not from a page subscription\n    res.sendStatus(404);\n  }\n});\n\n// Gets users name from facebook graph api\n// function getName(sender_psid,callback){\n//     var name = \"Empty\";\n//     request({\n//         url:\"https://graph.facebook.com/v3.3/\" + sender_psid,\n//         qs:{\n//             access_token: PAGE_ACCESS_TOKEN,\n//             fields: \"first_name\",\n//         },\n//         method:\"GET\"\n//     }, function(error,response,body){\n//         if (error){\n//             console.log(error)\n//         }else{\n//             var bodyObj = JSON.parse(body);\n//             name = bodyObj.first_name;\n//             console.log(\"Name: \" + name);\n//             return callback(name)\n//         }\n//     });\n//     return name;\n// }\n\n// Handles messages events\nfunction handleMessage(sender_psid, received_message) {\n  let response;\n  \n  // Check if the message contains text\n  if (received_message.text) {\n    console.log(`Received message: \"${received_message.text}\"`);\n    \n    // Default response (for debugging)\n    // Create the payload for a basic text message\n    // response = {\n    //   text: `You sent the message: \"${received_message.text}\".`\n    // };\n  } else {\n    response = defaultResponse();\n//     // Gets the URL of the message attachment\n//     let attachment_url = received_message.attachments[0].payload.url;\n    \n//     response = {\n//       attachment: {\n//         type: \"template\",\n//         payload: {\n//           template_type: \"generic\",\n//           elements: [\n//             {\n//               title: \"Is this the right picture?\",\n//               subtitle: \"Tap a button to answer.\",\n//               image_url: attachment_url,\n//               buttons: [\n//                 {\n//                   type: \"postback\",\n//                   title: \"Yes!\",\n//                   payload: \"yes\"\n//                 },\n//                 {\n//                   type: \"postback\",\n//                   title: \"No!\",\n//                   payload: \"no\"\n//                 }\n//               ]\n//             }\n//           ]\n//         }\n//       }\n//     };\n    \n  }\n\n  // Sends the response message\n  callSendAPI(sender_psid, response);\n}\n\nfunction processMessage(message) {\n  // NLP: https://developers.facebook.com/docs/messenger-platform/built-in-nlp\n  let entities = message.nlp[\"entities\"];\n\n  // Check greeting\n  let is_greeting =\n    entities[\"greetings\"] != null &&\n    entities[\"greetings\"][0][\"confidence\"] > 0.8; // Greeting threshold set to 0.8\n\n  // Retrieve first intent object\n  let intent = entities[\"intent\"][0];\n\n  if (intent[\"confidence\"] > 0.5) {\n    // Process intent\n    let intent_category = intent.split(\"_\")[0];\n    let response = null;\n\n    if (intent_category === \"recommendation\") {\n      // Handle recommendation\n    }\n\n    if (intent_category === \"enquiry\") {\n      // Handle enquiry\n    }\n\n    if (intent_category === \"cart\") {\n      // Handle shopping cart\n    }\n\n    if (intent_category === \"return\") {\n      // Handle order returns\n    }\n\n    if (intent_category === \"refund\") {\n      // Handle order refund\n    }\n\n    if (response === null) {\n      return defaultResponse();\n    }\n\n    return response;\n  } else if (is_greeting) {\n    // Message has no intent, just greeting\n    return generateResponseFromMessage(\n      \"Hi there! Welcome to MINDS. How can I help you?\"\n    );\n  }\n\n  Object.keys(entities).forEach(key => {\n    console.log(key);\n    console.log(entities[key]);\n  });\n\n  return defaultResponse();\n}\n\nfunction defaultResponse() {\n  return generateResponseFromMessage(\n    \"We could not understand your message. Kindly rephrase your message and send us again.\"\n  );\n}\n\nfunction generateResponseFromMessage(message) {\n  return {\n    text: message\n  };\n}\n\n// Handles messaging_postbacks events\nfunction handlePostback(sender_psid, received_postback) {\n  let response;\n  \n//   // Get the payload for the postback\n//   let payload = received_postback.payload;\n  \n//   // Set the response based on the postback payload\n//   if (payload === \"yes\") {\n//     response = { text: \"Thanks!\" };\n//   } else if (payload === \"no\") {\n//     response = { text: \"Oops, try sending another image.\" };\n//   }\n  \n  response = defaultResponse();\n  \n  // Send the message to acknowledge the postback\n  callSendAPI(sender_psid, response);\n}\n\n// Sends response messages via the Send API\nfunction callSendAPI(sender_psid, response) {\n  // Construct the message body\n  let request_body = {\n    recipient: {\n      id: sender_psid\n    },\n    message: response\n  };\n\n  // Send the HTTP request to the Messenger Platform\n  request(\n    {\n      uri: \"https://graph.facebook.com/v2.6/me/messages\",\n      qs: { access_token: PAGE_ACCESS_TOKEN },\n      method: \"POST\",\n      json: request_body\n    },\n    (err, res, body) => {\n      if (!err) {\n        console.log(\"message sent!\");\n      } else {\n        console.error(\"Unable to send message:\" + err);\n      }\n    }\n  );\n}\n"
      ]
    },
    "mtime": 1592291143000
  },
  "{\"filename\":\"/app/DBConn.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.26.3": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "checkUser",
            "createUser"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "checkUser",
              "exported": "checkUser"
            },
            {
              "kind": "local",
              "local": "createUser",
              "exported": "createUser"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/app/DBConn.js",
      "filenameRelative": "/app/DBConn.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "DBConn.js",
      "sourceFileName": "DBConn.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "DBConn"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar Pool = require('pg').Pool;\nvar pool = new Pool({\n    user: DB_USER,\n    host: DB_HOST,\n    database: DB_NAME,\n    password: DB_PASSWORD,\n    port: DB_PORT\n});\n\nfunction checkUser(fbid, name) {\n    var rowCount = \"\";\n\n    pool.query('SELECT * FROM users where fbid= $1', [fbid], function (error, results) {\n        if (error) {\n            throw error;\n        }\n\n        rowCount = results.rowCount;\n        if (rowCount == 0) {\n            createUser(fbid, name);\n        }\n    });\n\n    return rowCount;\n}\n\nfunction createUser(fbid, name) {\n    console.log(fbid + \" \" + name);\n    pool.query('INSERT INTO users(fbid,name) VALUES ($1,$2)', [fbid, name], function (error, results) {\n        if (error) {\n            throw error;\n        }\n        console.log(results.insertId);\n    });\n}\n\nexports.checkUser = checkUser;\nexports.createUser = createUser;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRCQ29ubi5qcyJdLCJuYW1lcyI6WyJQb29sIiwicmVxdWlyZSIsInBvb2wiLCJ1c2VyIiwiREJfVVNFUiIsImhvc3QiLCJEQl9IT1NUIiwiZGF0YWJhc2UiLCJEQl9OQU1FIiwicGFzc3dvcmQiLCJEQl9QQVNTV09SRCIsInBvcnQiLCJEQl9QT1JUIiwiY2hlY2tVc2VyIiwiZmJpZCIsIm5hbWUiLCJyb3dDb3VudCIsInF1ZXJ5IiwiZXJyb3IiLCJyZXN1bHRzIiwiY3JlYXRlVXNlciIsImNvbnNvbGUiLCJsb2ciLCJpbnNlcnRJZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxJQUFNQSxPQUFPQyxRQUFRLElBQVIsRUFBY0QsSUFBM0I7QUFDQSxJQUFNRSxPQUFPLElBQUlGLElBQUosQ0FBUztBQUNwQkcsVUFBTUMsT0FEYztBQUVwQkMsVUFBTUMsT0FGYztBQUdwQkMsY0FBVUMsT0FIVTtBQUlwQkMsY0FBVUMsV0FKVTtBQUtwQkMsVUFBTUM7QUFMYyxDQUFULENBQWI7O0FBUUEsU0FBU0MsU0FBVCxDQUFtQkMsSUFBbkIsRUFBd0JDLElBQXhCLEVBQTZCO0FBQ3pCLFFBQUlDLFdBQVcsRUFBZjs7QUFFQWQsU0FBS2UsS0FBTCxDQUFXLG9DQUFYLEVBQWdELENBQUNILElBQUQsQ0FBaEQsRUFBd0QsVUFBQ0ksS0FBRCxFQUFRQyxPQUFSLEVBQW9CO0FBQzVFLFlBQUlELEtBQUosRUFBVztBQUNQLGtCQUFNQSxLQUFOO0FBQ0g7O0FBRURGLG1CQUFXRyxRQUFRSCxRQUFuQjtBQUNBLFlBQUlBLFlBQVksQ0FBaEIsRUFBa0I7QUFDZEksdUJBQVdOLElBQVgsRUFBZ0JDLElBQWhCO0FBQ0g7QUFDQSxLQVREOztBQVdBLFdBQU9DLFFBQVA7QUFDSDs7QUFFRCxTQUFTSSxVQUFULENBQW9CTixJQUFwQixFQUF5QkMsSUFBekIsRUFBOEI7QUFDMUJNLFlBQVFDLEdBQVIsQ0FBWVIsT0FBTyxHQUFQLEdBQWFDLElBQXpCO0FBQ0FiLFNBQUtlLEtBQUwsQ0FBVyw2Q0FBWCxFQUF5RCxDQUFDSCxJQUFELEVBQU1DLElBQU4sQ0FBekQsRUFBcUUsVUFBQ0csS0FBRCxFQUFPQyxPQUFQLEVBQW1CO0FBQ3BGLFlBQUlELEtBQUosRUFBVTtBQUNOLGtCQUFNQSxLQUFOO0FBQ0g7QUFDREcsZ0JBQVFDLEdBQVIsQ0FBWUgsUUFBUUksUUFBcEI7QUFDSCxLQUxEO0FBTUg7O1FBRVFWLFMsR0FBQUEsUztRQUFXTyxVLEdBQUFBLFUiLCJmaWxlIjoiREJDb25uLmpzIiwic291cmNlUm9vdCI6Ii9hcHAiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBQb29sID0gcmVxdWlyZSgncGcnKS5Qb29sXG5jb25zdCBwb29sID0gbmV3IFBvb2woe1xuICB1c2VyOiBEQl9VU0VSLFxuICBob3N0OiBEQl9IT1NULFxuICBkYXRhYmFzZTogREJfTkFNRSxcbiAgcGFzc3dvcmQ6IERCX1BBU1NXT1JELFxuICBwb3J0OiBEQl9QT1JULFxufSlcblxuZnVuY3Rpb24gY2hlY2tVc2VyKGZiaWQsbmFtZSl7XG4gICAgdmFyIHJvd0NvdW50ID0gXCJcIjtcbiAgICBcbiAgICBwb29sLnF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIHdoZXJlIGZiaWQ9ICQxJyxbZmJpZF0sIChlcnJvciwgcmVzdWx0cykgPT4ge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgXG4gICAgcm93Q291bnQgPSByZXN1bHRzLnJvd0NvdW50XG4gICAgaWYgKHJvd0NvdW50ID09IDApe1xuICAgICAgICBjcmVhdGVVc2VyKGZiaWQsbmFtZSk7XG4gICAgfVxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIHJvd0NvdW50O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVVc2VyKGZiaWQsbmFtZSl7XG4gICAgY29uc29sZS5sb2coZmJpZCArIFwiIFwiICsgbmFtZSlcbiAgICBwb29sLnF1ZXJ5KCdJTlNFUlQgSU5UTyB1c2VycyhmYmlkLG5hbWUpIFZBTFVFUyAoJDEsJDIpJyxbZmJpZCxuYW1lXSwoZXJyb3IscmVzdWx0cykgPT4ge1xuICAgICAgICBpZiAoZXJyb3Ipe1xuICAgICAgICAgICAgdGhyb3cgZXJyb3JcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzLmluc2VydElkKVxuICAgIH0pXG59XG5cbmV4cG9ydCB7IGNoZWNrVXNlciwgY3JlYXRlVXNlciB9O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "DBConn.js"
      ],
      "names": [
        "Pool",
        "require",
        "pool",
        "user",
        "DB_USER",
        "host",
        "DB_HOST",
        "database",
        "DB_NAME",
        "password",
        "DB_PASSWORD",
        "port",
        "DB_PORT",
        "checkUser",
        "fbid",
        "name",
        "rowCount",
        "query",
        "error",
        "results",
        "createUser",
        "console",
        "log",
        "insertId"
      ],
      "mappings": ";;;;;AAAA,IAAMA,OAAOC,QAAQ,IAAR,EAAcD,IAA3B;AACA,IAAME,OAAO,IAAIF,IAAJ,CAAS;AACpBG,UAAMC,OADc;AAEpBC,UAAMC,OAFc;AAGpBC,cAAUC,OAHU;AAIpBC,cAAUC,WAJU;AAKpBC,UAAMC;AALc,CAAT,CAAb;;AAQA,SAASC,SAAT,CAAmBC,IAAnB,EAAwBC,IAAxB,EAA6B;AACzB,QAAIC,WAAW,EAAf;;AAEAd,SAAKe,KAAL,CAAW,oCAAX,EAAgD,CAACH,IAAD,CAAhD,EAAwD,UAACI,KAAD,EAAQC,OAAR,EAAoB;AAC5E,YAAID,KAAJ,EAAW;AACP,kBAAMA,KAAN;AACH;;AAEDF,mBAAWG,QAAQH,QAAnB;AACA,YAAIA,YAAY,CAAhB,EAAkB;AACdI,uBAAWN,IAAX,EAAgBC,IAAhB;AACH;AACA,KATD;;AAWA,WAAOC,QAAP;AACH;;AAED,SAASI,UAAT,CAAoBN,IAApB,EAAyBC,IAAzB,EAA8B;AAC1BM,YAAQC,GAAR,CAAYR,OAAO,GAAP,GAAaC,IAAzB;AACAb,SAAKe,KAAL,CAAW,6CAAX,EAAyD,CAACH,IAAD,EAAMC,IAAN,CAAzD,EAAqE,UAACG,KAAD,EAAOC,OAAP,EAAmB;AACpF,YAAID,KAAJ,EAAU;AACN,kBAAMA,KAAN;AACH;AACDG,gBAAQC,GAAR,CAAYH,QAAQI,QAApB;AACH,KALD;AAMH;;QAEQV,S,GAAAA,S;QAAWO,U,GAAAA,U",
      "file": "DBConn.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "const Pool = require('pg').Pool\nconst pool = new Pool({\n  user: DB_USER,\n  host: DB_HOST,\n  database: DB_NAME,\n  password: DB_PASSWORD,\n  port: DB_PORT,\n})\n\nfunction checkUser(fbid,name){\n    var rowCount = \"\";\n    \n    pool.query('SELECT * FROM users where fbid= $1',[fbid], (error, results) => {\n    if (error) {\n        throw error;\n    }\n    \n    rowCount = results.rowCount\n    if (rowCount == 0){\n        createUser(fbid,name);\n    }\n    })\n    \n    return rowCount;\n}\n\nfunction createUser(fbid,name){\n    console.log(fbid + \" \" + name)\n    pool.query('INSERT INTO users(fbid,name) VALUES ($1,$2)',[fbid,name],(error,results) => {\n        if (error){\n            throw error\n        }\n        console.log(results.insertId)\n    })\n}\n\nexport { checkUser, createUser };\n"
      ]
    },
    "mtime": 1592290107000
  }
}